import{ap as jr,y as br,r as n,j as e,aq as Ye,ar as es,as as vr,at as wr,k as ie,au as Nr,av as ms,aw as yr,ax as _r,ay as kr,az as Cr,aA as Sr,aB as Dr,aC as Rr,aD as Tr,aE as Pr,aF as Ar,aG as Ds,aH as us,aI as zr}from"./vendor-DnMDzfgH.js";import{S as Rs,C as Ts,a as Er,R as Ps,O as As,P as Ir,b as zs,c as $r,T as Es,D as Is,d as Lr,e as Or,f as $s,g as Ls,V as Fr,h as Br,i as Os,j as Mr,k as Vr,l as Fs,m as Hr,n as qr,o as Ur,p as Bs,q as Wr,r as Gr,s as Xr,L as Ms,t as Vs,u as Hs,v as Zr,w as qs,x as Us,y as Kr,z as Ws,I as Gs,A as Xs,B as Zs,E as Ks,F as Js,G as Qs,H as Jr,J as Qr}from"./vendor-radix-gVgaAjsd.js";import{C as ve,X as Le,E as Yr,a as ea,I as Re,G as sa,b as ra,c as aa,T as ss,P as rs,d as ze,L as he,e as ta,f as na,S as We,R as la,M as Ys,g as Ge,h as $e,i as oa,Z as xs,j as hs,k as ps,l as fs,m as gs,n as He,o as qe,p as js,A as ia,q as ca,r as da}from"./vendor-lucide-CQW8uerW.js";import{R as ma,T as ua,A as bs,a as vs}from"./vendor-recharts-CMiKEC77.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const m of t)if(m.type==="childList")for(const o of m.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function a(t){const m={};return t.integrity&&(m.integrity=t.integrity),t.referrerPolicy&&(m.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?m.credentials="include":t.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(t){if(t.ep)return;t.ep=!0;const m=a(t);fetch(t.href,m)}})();function y(...s){return jr(br(s))}const xa=Ye("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),E=n.forwardRef(({className:s,variant:r,size:a,asChild:l=!1,...t},m)=>{const o=l?Rs:"button";return e.jsx(o,{className:y(xa({variant:r,size:a,className:s})),ref:m,...t})});E.displayName="Button";const T=n.forwardRef(({className:s,type:r,...a},l)=>e.jsx("input",{type:r,className:y("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:l,...a}));T.displayName="Input";const we=n.forwardRef(({className:s,...r},a)=>e.jsx(Ts,{ref:a,className:y("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:e.jsx(Er,{className:y("grid place-content-center text-current"),children:e.jsx(ve,{className:"h-4 w-4"})})}));we.displayName=Ts.displayName;const ha=Ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ce=n.forwardRef(({className:s,...r},a)=>e.jsx(Ps,{ref:a,className:y(ha(),s),...r}));ce.displayName=Ps.displayName;const er=Lr,pa=Or,fa=Ir,sr=n.forwardRef(({className:s,...r},a)=>e.jsx(As,{ref:a,className:y("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r}));sr.displayName=As.displayName;const as=n.forwardRef(({className:s,children:r,...a},l)=>e.jsxs(fa,{children:[e.jsx(sr,{}),e.jsxs(zs,{ref:l,className:y("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[r,e.jsxs($r,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));as.displayName=zs.displayName;const ts=({className:s,...r})=>e.jsx("div",{className:y("flex flex-col space-y-1.5 text-center sm:text-left",s),...r});ts.displayName="DialogHeader";const rr=({className:s,...r})=>e.jsx("div",{className:y("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...r});rr.displayName="DialogFooter";const ns=n.forwardRef(({className:s,...r},a)=>e.jsx(Es,{ref:a,className:y("text-lg font-semibold leading-none tracking-tight",s),...r}));ns.displayName=Es.displayName;const ls=n.forwardRef(({className:s,...r},a)=>e.jsx(Is,{ref:a,className:y("text-sm text-muted-foreground",s),...r}));ls.displayName=Is.displayName;const q=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r}));q.displayName="Card";const W=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("flex flex-col space-y-1.5 p-6",s),...r}));W.displayName="CardHeader";const J=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("text-2xl font-semibold leading-none tracking-tight",s),...r}));J.displayName="CardTitle";const pe=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("text-sm text-muted-foreground",s),...r}));pe.displayName="CardDescription";const U=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("p-6 pt-0",s),...r}));U.displayName="CardContent";const ga=n.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:y("flex items-center p-6 pt-0",s),...r}));ga.displayName="CardFooter";const ar=n.forwardRef(({className:s,orientation:r="horizontal",decorative:a=!0,...l},t)=>e.jsx($s,{ref:t,decorative:a,orientation:r,className:y("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...l}));ar.displayName=$s.displayName;const tr=n.forwardRef(({className:s,children:r,...a},l)=>e.jsxs(Ls,{ref:l,className:y("relative overflow-hidden",s),...a,children:[e.jsx(Fr,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(nr,{}),e.jsx(Br,{})]}));tr.displayName=Ls.displayName;const nr=n.forwardRef(({className:s,orientation:r="vertical",...a},l)=>e.jsx(Os,{ref:l,orientation:r,className:y("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Mr,{className:"relative flex-1 rounded-full bg-border"})}));nr.displayName=Os.displayName;const ja=wr,lr=n.createContext(null),f=({...s})=>e.jsx(lr.Provider,{value:{name:s.name},children:e.jsx(vr,{...s})}),Be=()=>{const s=n.useContext(lr),r=n.useContext(or),{getFieldState:a,formState:l}=es();if(!s)throw new Error("useFormField should be used within <FormField>");if(!r)throw new Error("useFormField should be used within <FormItem>");const t=a(s.name,l),{id:m}=r;return{id:m,name:s.name,formItemId:`${m}-form-item`,formDescriptionId:`${m}-form-item-description`,formMessageId:`${m}-form-item-message`,...t}},or=n.createContext(null),j=n.forwardRef(({className:s,...r},a)=>{const l=n.useId();return e.jsx(or.Provider,{value:{id:l},children:e.jsx("div",{ref:a,className:y("space-y-2",s),...r})})});j.displayName="FormItem";const C=n.forwardRef(({className:s,...r},a)=>{const{error:l,formItemId:t}=Be();return e.jsx(ce,{ref:a,className:y(l&&"text-destructive",s),htmlFor:t,...r})});C.displayName="FormLabel";const b=n.forwardRef(({...s},r)=>{const{error:a,formItemId:l,formDescriptionId:t,formMessageId:m}=Be();return e.jsx(Rs,{ref:r,id:l,"aria-describedby":a?`${t} ${m}`:`${t}`,"aria-invalid":!!a,...s})});b.displayName="FormControl";const Y=n.forwardRef(({className:s,...r},a)=>{const{formDescriptionId:l}=Be();return e.jsx("p",{ref:a,id:l,className:y("text-[0.8rem] text-muted-foreground",s),...r})});Y.displayName="FormDescription";const N=n.forwardRef(({className:s,children:r,...a},l)=>{const{error:t,formMessageId:m}=Be(),o=t?String(t?.message??""):r;return o?e.jsx("p",{ref:l,id:m,className:y("text-[0.8rem] font-medium text-destructive",s),...a,children:o}):null});N.displayName="FormMessage";const Ee=n.forwardRef(({className:s,...r},a)=>{const[l,t]=n.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx(T,{type:l?"text":"password",className:y("pr-10",s),ref:a,...r}),e.jsx("button",{type:"button",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent text-muted-foreground hover:text-foreground",onClick:()=>t(!l),tabIndex:-1,children:l?e.jsx(Yr,{className:"h-4 w-4"}):e.jsx(ea,{className:"h-4 w-4"})})]})});Ee.displayName="PasswordInput";const Te=Hr,Pe=qr,Ae=Ur,Ce=n.forwardRef(({className:s,sideOffset:r=4,...a},l)=>e.jsx(Vr,{children:e.jsx(Fs,{ref:l,sideOffset:r,className:y("z-[100] overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));Ce.displayName=Fs.displayName;const ba=Ye("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Oe({className:s,variant:r,...a}){return e.jsx("div",{className:y(ba({variant:r}),s),...a})}const va=["BluRay","BluRay REMUX","WEB-DL","WEBRip","HDTV","DVDRip","BRRip"],wa=["CAM","TeleSync","TeleCine","SCR"],ws=["2160p","1080p","720p","480p"],Ns=["HEVC","AVC","MPEG-2"],Na=["Atmos","TrueHD","DTS Lossless","DTS Lossy","DDP","DD","AAC"],ys=["DV","HDR10+","HDR","3D"],ya=["en","multi","dual audio"],z={quality:{cam:["CAM","TeleSync","TeleCine","SCR"],web:["WEB","WEB-DL","WEBRip","WEB-DLRip"],broadcast:["HDTV","HDTVRip","PDTV","TVRip","SATRip"],physical:["BluRay","BluRay REMUX","REMUX","BRRip","BDRip","UHDRip","HDRip","DVD","DVDRip","PPVRip","R5"],other:["XviD","DivX"]},resolution:["4k (2160p)","2k (1440p)","1080p","720p","576p","480p","360p","240p"],codec:{AVC:["avc","h264","x264"],HEVC:["hevc","h265","x265"],"MPEG-2":["mpeg2"],DivX:["divx","dvix"],Xvid:["xvid"]},audio:["DTS Lossless","DTS Lossy","Atmos","TrueHD","FLAC","DDP","EAC3","DD","AC3","AAC","PCM","OPUS","HQ","MP3"],channels:["2.0","5.1","7.1","stereo","mono"],visualTags:{hdr:["DV","HDR10+","HDR","SDR"],threeD:["3D","3D HSBS","3D SBS","3D HOU","3D OU"]},languages:{special:["multi subs","multi audio","dual audio"],iso6391:["en","ja","ko","zh","zh-tw","fr","es","es-419","pt","it","de","ru","uk","nl","da","fi","sv","no","el","lt","lv","et","pl","cs","sk","hu","ro","bg","sr","hr","sl","hi","te","ta","ml","kn","mr","gu","pa","bn","vi","id","th","ms","ar","tr","he","fa"]}};function ne({label:s,tooltipContent:r,className:a}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:a,children:s}),e.jsxs(Pe,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-help hover:text-foreground"})}),e.jsx(Ce,{className:"max-w-md p-3 z-[100]",side:"bottom",sideOffset:5,avoidCollisions:!0,collisionPadding:8,children:e.jsx("div",{className:"text-sm space-y-1",children:r})})]})]})}function me({value:s=[],onChange:r,options:a,placeholder:l}){const[t,m]=ie.useState(""),o=c=>{c&&!s.includes(c)&&r([...s,c])},d=c=>{r(s.filter(p=>p!==c))};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex flex-wrap gap-2 min-h-[2.5rem] p-2 border rounded-md",children:s.map(c=>e.jsxs(Oe,{variant:"secondary",className:"gap-1",children:[c,e.jsx(Le,{className:"h-3 w-3 cursor-pointer",onClick:()=>d(c)})]},c))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(T,{value:t,onChange:c=>m(c.target.value),onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),o(t),m(""))},placeholder:l||"Type and press Enter",className:"flex-1"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.filter(c=>!s.includes(c)).slice(0,5).map(c=>e.jsx(Oe,{variant:"outline",className:"cursor-pointer hover:bg-accent",onClick:()=>{o(c),m("")},children:c},c))})]})]})}function ir({control:s,watch:r,fieldPrefix:a=""}){let l=null;try{l=es()}catch{}const t=s||l?.control;r||l?.watch;const m=o=>a?o.startsWith("filters.")?a==="filters"?o:`${a}.${o}`:a==="filters"?`filters.${o}`:`${a}.filters.${o}`:o;return e.jsx(Te,{children:e.jsxs(q,{children:[e.jsxs(W,{children:[e.jsx(J,{className:"text-lg",children:"Release Filters"}),e.jsx(pe,{children:"Filter search results based on quality, codec, audio, and other release attributes. Leave fields empty to allow all."})]}),e.jsxs(U,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Quality"}),e.jsx(f,{control:t,name:m("filters.allowed_qualities"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Allowed Qualities",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cam:"})," ",z.quality.cam.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Web:"})," ",z.quality.web.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Broadcast:"})," ",z.quality.broadcast.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Physical:"})," ",z.quality.physical.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Other:"})," ",z.quality.other.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:va,placeholder:"Add allowed quality..."})}),e.jsx(Y,{children:"Leave empty to allow all"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.blocked_qualities"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Blocked Qualities",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Cam:"})," ",z.quality.cam.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Web:"})," ",z.quality.web.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Broadcast:"})," ",z.quality.broadcast.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Physical:"})," ",z.quality.physical.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Other:"})," ",z.quality.other.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:wa,placeholder:"Add blocked quality..."})}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.block_cam"),render:({field:o})=>e.jsxs(j,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(b,{children:e.jsx(we,{checked:o.value,onCheckedChange:o.onChange})}),e.jsx(C,{className:"font-normal",children:"Block CAM/TS/TC releases"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Resolution"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(f,{control:t,name:m("filters.min_resolution"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Minimum Resolution",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsx("div",{children:z.resolution.join(", ")})]})}),e.jsx(b,{children:e.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",...o,children:[e.jsx("option",{value:"",children:"Any"}),ws.map(d=>e.jsx("option",{value:d,children:d},d))]})}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.max_resolution"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Maximum Resolution",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsx("div",{children:z.resolution.join(", ")})]})}),e.jsx(b,{children:e.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",...o,children:[e.jsx("option",{value:"",children:"Any"}),ws.map(d=>e.jsx("option",{value:d,children:d},d))]})}),e.jsx(N,{})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Codec"}),e.jsx(f,{control:t,name:m("filters.allowed_codecs"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Allowed Codecs",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"AVC:"})," ",z.codec.AVC.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"HEVC:"})," ",z.codec.HEVC.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"MPEG-2:"})," ",z.codec["MPEG-2"].join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"DivX:"})," ",z.codec.DivX.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Xvid:"})," ",z.codec.Xvid.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:Ns,placeholder:"Add allowed codec..."})}),e.jsx(Y,{children:"Leave empty to allow all"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.blocked_codecs"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Blocked Codecs",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"AVC:"})," ",z.codec.AVC.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"HEVC:"})," ",z.codec.HEVC.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"MPEG-2:"})," ",z.codec["MPEG-2"].join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"DivX:"})," ",z.codec.DivX.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Xvid:"})," ",z.codec.Xvid.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:Ns,placeholder:"Add blocked codec..."})}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Audio"}),e.jsx(f,{control:t,name:m("filters.allowed_audio"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Allowed Audio Formats",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsx("div",{children:z.audio.join(", ")})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:Na,placeholder:"Add allowed audio..."})}),e.jsx(Y,{children:"Leave empty to allow all"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.min_channels"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Minimum Channels",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsx("div",{children:z.channels.join(", ")})]})}),e.jsx(b,{children:e.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring",...o,children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"2.0",children:"2.0 (Stereo)"}),e.jsx("option",{value:"5.1",children:"5.1"}),e.jsx("option",{value:"7.1",children:"7.1"})]})}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Visual Tags"}),e.jsx(f,{control:t,name:m("filters.require_hdr"),render:({field:o})=>e.jsxs(j,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(b,{children:e.jsx(we,{checked:o.value,onCheckedChange:o.onChange})}),e.jsx(C,{className:"font-normal",children:"Require Visual Tag"})]})}),e.jsx(f,{control:t,name:m("filters.allowed_hdr"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Allowed Visual Tags",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"HDR:"})," ",z.visualTags.hdr.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"3D:"})," ",z.visualTags.threeD.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:ys,placeholder:"Add visual tag..."})}),e.jsx(Y,{children:"Leave empty to allow all visual tags"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.blocked_hdr"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Blocked Visual Tags",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"HDR:"})," ",z.visualTags.hdr.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"3D:"})," ",z.visualTags.threeD.join(", ")]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:ys,placeholder:"Add blocked visual tag (e.g., DV)..."})}),e.jsx(Y,{children:"Block specific visual tags like Dolby Vision (DV) or 3D"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.block_sdr"),render:({field:o})=>e.jsxs(j,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(b,{children:e.jsx(we,{checked:o.value,onCheckedChange:o.onChange})}),e.jsx(C,{className:"font-normal",children:"Block SDR releases"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Languages"}),e.jsx(f,{control:t,name:m("filters.allowed_languages"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(ne,{label:"Allowed Languages",tooltipContent:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-1",children:"Possible values:"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Special:"})," ",z.languages.special.join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"ISO 639-1:"})," ",z.languages.iso6391.slice(0,20).join(", "),"..."]}),e.jsxs("div",{className:"text-xs mt-1",children:["(and more: ",z.languages.iso6391.slice(20).join(", "),")"]})]})}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:ya,placeholder:"Add language code..."})}),e.jsx(Y,{children:"Leave empty to allow all"}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"File Size"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(f,{control:t,name:m("filters.min_size_gb"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(C,{children:"Minimum Size (GB)"}),e.jsx(b,{children:e.jsx(T,{type:"number",step:"0.1",placeholder:"0",...o,onChange:d=>o.onChange(d.target.valueAsNumber||0)})}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("filters.max_size_gb"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(C,{children:"Maximum Size (GB)"}),e.jsx(b,{children:e.jsx(T,{type:"number",step:"0.1",placeholder:"0",...o,onChange:d=>o.onChange(d.target.valueAsNumber||0)})}),e.jsx(N,{})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Release Groups"}),e.jsx(f,{control:t,name:m("filters.blocked_groups"),render:({field:o})=>e.jsxs(j,{children:[e.jsx(C,{children:"Blocked Groups"}),e.jsx(b,{children:e.jsx(me,{value:o.value||[],onChange:o.onChange,options:[],placeholder:"Add group name..."})}),e.jsx(N,{})]})})]})]})]})})}function _a({id:s,children:r}){const{attributes:a,listeners:l,setNodeRef:t,transform:m,transition:o,isDragging:d}=Pr({id:s}),c={transform:Ar.Transform.toString(m),transition:o,opacity:d?.5:1};return e.jsxs("div",{ref:t,style:c,className:"flex items-center gap-2 p-3 bg-background border rounded-md hover:bg-accent/50 transition-colors",children:[e.jsx("div",{...a,...l,className:"cursor-grab active:cursor-grabbing text-muted-foreground hover:text-foreground",children:e.jsx(sa,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1",children:r})]})}function ka({items:s,onReorder:r}){const a=Nr(ms(Tr),ms(Rr,{coordinateGetter:Dr})),l=t=>{const{active:m,over:o}=t;if(m.id!==o.id){const d=s.findIndex(p=>p.id===m.id),c=s.findIndex(p=>p.id===o.id);r(Sr(s,d,c))}};return e.jsx(yr,{sensors:a,collisionDetection:_r,onDragEnd:l,children:e.jsx(kr,{items:s.map(t=>t.id),strategy:Cr,children:e.jsx("div",{className:"space-y-2",children:s.map(t=>e.jsx(_a,{id:t.id,children:t.label},t.id))})})})}const cr=n.forwardRef(({className:s,...r},a)=>e.jsxs(Bs,{ref:a,className:`relative flex w-full touch-none select-none items-center ${s||""}`,...r,children:[e.jsx(Wr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Gr,{className:"absolute h-full bg-primary"})}),e.jsx(Xr,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));cr.displayName=Bs.displayName;function De({items:s,value:r={},onChange:a,title:l,description:t}){const m=r||{},[o,d]=n.useState(()=>[...s].sort((g,i)=>(m[i.key]||0)-(m[g.key]||0)));n.useEffect(()=>{const g=r||{},i=[...s].sort((w,k)=>(g[k.key]||0)-(g[w.key]||0));d(i)},[r,s]);const c=g=>{d(g);const i={},w=1e6;g.forEach((k,L)=>{const I=g.length-L;i[k.key]=w*I}),a(i)},p=o.map(g=>({id:g.key,label:g.label}));return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:l}),t&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t})]}),e.jsx(ka,{items:p,onReorder:g=>{const i=g.map(w=>o.find(k=>k.key===w.id));c(i)}})]})}function _s({label:s,value:r=1,onChange:a,min:l=0,max:t=2,step:m=.1,description:o}){return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s}),o&&e.jsx("p",{className:"text-sm text-muted-foreground",children:o})]}),e.jsx("span",{className:"text-sm font-mono bg-muted px-2 py-1 rounded",children:r.toFixed(1)})]}),e.jsx(cr,{value:[r],onValueChange:d=>a(d[0]),min:l,max:t,step:m,className:"w-full"})]})}function dr({control:s,watch:r,fieldPrefix:a=""}){let l=null;try{l=es()}catch{}const t=s||l?.control;r||l?.watch;const m=i=>a?i.startsWith("sorting.")?a==="sorting"?i:`${a}.${i}`:a==="sorting"?`sorting.${i}`:`${a}.sorting.${i}`:i,o=[{key:"4k",label:"4K"},{key:"1080p",label:"1080p"},{key:"720p",label:"720p"},{key:"sd",label:"SD"}],d=[{key:"HEVC",label:"HEVC"},{key:"x265",label:"x265"},{key:"x264",label:"x264"},{key:"AVC",label:"AVC"}],c=[{key:"Atmos",label:"Atmos"},{key:"TrueHD",label:"TrueHD"},{key:"DTS-HD",label:"DTS-HD"},{key:"DTS-X",label:"DTS-X"},{key:"DTS",label:"DTS"},{key:"DD+",label:"DD+"},{key:"DD",label:"DD"},{key:"AC3",label:"AC3"},{key:"5.1",label:"5.1 Channels"},{key:"7.1",label:"7.1 Channels"}],p=[{key:"BluRay",label:"BluRay"},{key:"Blu-ray",label:"Blu-ray"},{key:"WEB-DL",label:"WEB-DL"},{key:"WEBRip",label:"WEBRip"},{key:"HDTV",label:"HDTV"}],g=[{key:"DV",label:"DV (Dolby Vision)"},{key:"HDR10+",label:"HDR10+"},{key:"HDR",label:"HDR"},{key:"3D",label:"3D"}];return e.jsxs(q,{children:[e.jsxs(W,{children:[e.jsx(J,{className:"text-lg",children:"Sorting Priority"}),e.jsx(pe,{children:"Drag items to reorder priority. Items at the top will be prioritized over items at the bottom."})]}),e.jsxs(U,{className:"space-y-6",children:[e.jsx(f,{control:t,name:m("sorting.resolution_weights"),render:({field:i})=>e.jsx(De,{items:o,value:i.value,onChange:i.onChange,title:"Resolution Priority",description:"Drag to set your preferred resolution order. Higher resolutions typically rank higher."})}),e.jsx(f,{control:t,name:m("sorting.codec_weights"),render:({field:i})=>e.jsx(De,{items:d,value:i.value,onChange:i.onChange,title:"Codec Preference",description:"Prioritize releases with your preferred video codecs."})}),e.jsx(f,{control:t,name:m("sorting.audio_weights"),render:({field:i})=>e.jsx(De,{items:c,value:i.value,onChange:i.onChange,title:"Audio Format Preference",description:"Prioritize releases with your preferred audio formats and channel configurations."})}),e.jsx(f,{control:t,name:m("sorting.quality_weights"),render:({field:i})=>e.jsx(De,{items:p,value:i.value,onChange:i.onChange,title:"Source Quality Preference",description:"Prioritize releases from your preferred sources."})}),e.jsx(f,{control:t,name:m("sorting.visual_tag_weights"),render:({field:i})=>e.jsx(De,{items:g,value:i.value,onChange:i.onChange,title:"Visual Tag Preference",description:"Prioritize releases with your preferred visual tags (HDR, Dolby Vision, 3D)."})}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium",children:"Preferred Settings"}),e.jsx(f,{control:t,name:m("sorting.preferred_groups"),render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"Preferred Release Groups"}),e.jsx(b,{children:e.jsx(T,{placeholder:"Enter groups separated by commas (e.g., FLUX, NTb, SWTYBLZ)",value:i.value?.join(", ")||"",onChange:w=>i.onChange(w.target.value.split(",").map(k=>k.trim()).filter(Boolean))})}),e.jsx(Y,{children:"Boost score for releases from these groups (+1000 points)"}),e.jsx(N,{})]})}),e.jsx(f,{control:t,name:m("sorting.preferred_languages"),render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"Preferred Languages"}),e.jsx(b,{children:e.jsx(T,{placeholder:"Enter language codes separated by commas (e.g., en, multi)",value:i.value?.join(", ")||"",onChange:w=>i.onChange(w.target.value.split(",").map(k=>k.trim()).filter(Boolean))})}),e.jsx(Y,{children:"Boost score for releases in these languages (future feature)"}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium",children:"Score Multipliers"}),e.jsx(f,{control:t,name:m("sorting.grab_weight"),render:({field:i})=>e.jsx(_s,{label:"Grab Weight",value:i.value||.5,onChange:i.onChange,min:0,max:2,step:.1,description:"How much to prioritize popular releases (higher grabs = more popular)"})}),e.jsx(f,{control:t,name:m("sorting.age_weight"),render:({field:i})=>e.jsx(_s,{label:"Age Weight",value:i.value||1,onChange:i.onChange,min:0,max:2,step:.1,description:"How much to prioritize newer releases (higher = prefer newer)"})})]})]})]})}const mr=Zr,os=n.forwardRef(({className:s,...r},a)=>e.jsx(Ms,{ref:a,className:`inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground ${s||""}`,...r}));os.displayName=Ms.displayName;const le=n.forwardRef(({className:s,...r},a)=>e.jsx(Vs,{ref:a,className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm ${s||""}`,...r}));le.displayName=Vs.displayName;const oe=n.forwardRef(({className:s,...r},a)=>e.jsx(Hs,{ref:a,className:`mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${s||""}`,...r}));oe.displayName=Hs.displayName;const Xe=Jr,Ze=Qr,Ca=n.forwardRef(({className:s,inset:r,children:a,...l},t)=>e.jsxs(qs,{ref:t,className:y("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...l,children:[a,e.jsx(ra,{className:"ml-auto"})]}));Ca.displayName=qs.displayName;const Sa=n.forwardRef(({className:s,...r},a)=>e.jsx(Us,{ref:a,className:y("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));Sa.displayName=Us.displayName;const Fe=n.forwardRef(({className:s,sideOffset:r=4,...a},l)=>e.jsx(Kr,{children:e.jsx(Ws,{ref:l,sideOffset:r,className:y("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));Fe.displayName=Ws.displayName;const te=n.forwardRef(({className:s,inset:r,...a},l)=>e.jsx(Gs,{ref:l,className:y("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...a}));te.displayName=Gs.displayName;const Da=n.forwardRef(({className:s,children:r,checked:a,...l},t)=>e.jsxs(Xs,{ref:t,className:y("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...l,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Zs,{children:e.jsx(ve,{className:"h-4 w-4"})})}),r]}));Da.displayName=Xs.displayName;const Ra=n.forwardRef(({className:s,children:r,...a},l)=>e.jsxs(Ks,{ref:l,className:y("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Zs,{children:e.jsx(aa,{className:"h-2 w-2 fill-current"})})}),r]}));Ra.displayName=Ks.displayName;const Ta=n.forwardRef(({className:s,inset:r,...a},l)=>e.jsx(Js,{ref:l,className:y("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...a}));Ta.displayName=Js.displayName;const Pa=n.forwardRef(({className:s,...r},a)=>e.jsx(Qs,{ref:a,className:y("-mx-1 my-1 h-px bg-muted",s),...r}));Pa.displayName=Qs.displayName;const Ue=[{name:"abNZB",url:"https://abnzb.com",api_path:"/api",type:"newznab"},{name:"altHUB",url:"https://api.althub.co.za",api_path:"/api",type:"newznab"},{name:"AnimeTosho (Usenet)",url:"https://feed.animetosho.org",api_path:"/api",type:"newznab"},{name:"DOGnzb",url:"https://api.dognzb.cr",api_path:"/api",type:"newznab"},{name:"DrunkenSlug",url:"https://drunkenslug.com",api_path:"/api",type:"newznab"},{name:"GingaDADDY",url:"https://www.gingadaddy.com",api_path:"/api",type:"newznab"},{name:"Miatrix",url:"https://www.miatrix.com",api_path:"/api",type:"newznab"},{name:"Newz69",url:"https://newz69.keagaming.com",api_path:"/api",type:"newznab"},{name:"NinjaCentral",url:"https://ninjacentral.co.za",api_path:"/api",type:"newznab"},{name:"Nzb.life",url:"https://api.nzb.life",api_path:"/api",type:"newznab"},{name:"NZBCat",url:"https://nzb.cat",api_path:"/api",type:"newznab"},{name:"NZBFinder",url:"https://nzbfinder.ws",api_path:"/api",type:"newznab"},{name:"NZBgeek",url:"https://api.nzbgeek.info",api_path:"/api",type:"newznab"},{name:"NzbNoob",url:"https://www.nzbnoob.com",api_path:"/api",type:"newznab"},{name:"NZBNDX",url:"https://www.nzbndx.com",api_path:"/api",type:"newznab"},{name:"NzbPlanet",url:"https://api.nzbplanet.net",api_path:"/api",type:"newznab"},{name:"NZBStars",url:"https://nzbstars.com",api_path:"/api",type:"newznab"},{name:"SceneNZBs",url:"https://scenenzbs.com",api_path:"/api",type:"newznab"},{name:"Tabula Rasa",url:"https://www.tabula-rasa.pw",api_path:"/api/v1",type:"newznab"},{name:"Usenet Crawler",url:"https://www.usenet-crawler.com",api_path:"/api",type:"newznab"},{name:"Prowlarr",url:"",api_path:"/api",type:"prowlarr"},{name:"NZBHydra2",url:"",api_path:"/api",type:"nzbhydra"},{name:"Custom Newznab",url:"",api_path:"/api",type:"newznab"}];function Aa({control:s,indexerFields:r,appendIndexer:a,removeIndexer:l,watch:t,setValue:m}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.map((o,d)=>{const c=t(`indexers.${d}.type`)||"newznab",p=c==="prowlarr"||c==="nzbhydra",g=c==="easynews";return e.jsxs(q,{className:"relative flex flex-col h-full",children:[e.jsx(E,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1 h-8 w-8 text-destructive hover:text-destructive/90 z-10",onClick:()=>l(d),children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx(W,{className:"pb-3",children:e.jsx(J,{className:"text-base truncate pr-8",children:t(`indexers.${d}.name`)||`Indexer ${d+1}`})}),e.jsxs(U,{className:"space-y-4 flex-grow",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{children:"Preset / Type"}),e.jsx("select",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-1 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",onChange:i=>{const w=Ue.find(k=>k.name===i.target.value);w&&(m(`indexers.${d}.name`,w.name),m(`indexers.${d}.url`,w.url),m(`indexers.${d}.api_path`,w.api_path||"/api"),m(`indexers.${d}.type`,w.type))},value:Ue.find(i=>i.name===t(`indexers.${d}.name`))?.name||(t(`indexers.${d}.type`)==="prowlarr"?"Prowlarr":t(`indexers.${d}.type`)==="nzbhydra"?"NZBHydra2":t(`indexers.${d}.type`)==="easynews"?"Easynews (Experimental)":"Custom Newznab"),children:Ue.map(i=>e.jsx("option",{value:i.name,children:i.name},i.name))})]}),!g&&e.jsx(f,{control:s,name:`indexers.${d}.url`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"URL"}),e.jsx(b,{children:e.jsx(T,{placeholder:"https://api.nzbgeek.info",className:"h-8 text-xs",...i})}),e.jsx(N,{})]})}),!p&&!g&&e.jsx(f,{control:s,name:`indexers.${d}.api_path`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"API Path"}),e.jsx(b,{children:e.jsx(T,{placeholder:"/api",className:"h-8 text-xs",...i})}),e.jsx(Y,{className:"text-[10px]",children:"API endpoint path (default: /api, Tabula Rasa: /api/v1)"}),e.jsx(N,{})]})}),g?e.jsxs(e.Fragment,{children:[e.jsx(f,{control:s,name:`indexers.${d}.username`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"Username"}),e.jsx(b,{children:e.jsx(T,{className:"h-8 text-xs",...i})}),e.jsx(N,{})]})}),e.jsx(f,{control:s,name:`indexers.${d}.password`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"Password"}),e.jsx(b,{children:e.jsx(Ee,{className:"h-8 text-xs",...i})}),e.jsx(N,{})]})})]}):e.jsx(f,{control:s,name:`indexers.${d}.api_key`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{children:"API Key"}),e.jsx(b,{children:e.jsx(Ee,{className:"h-8 text-xs",...i})}),e.jsx(N,{})]})}),!p&&!g&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[e.jsx(f,{control:s,name:`indexers.${d}.api_hits_day`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-[10px]",children:"Hits/Day"}),e.jsx(b,{children:e.jsx(T,{type:"number",placeholder:"100",className:"h-8 text-xs",...i,onChange:w=>i.onChange(Number(w.target.value))})}),e.jsx(N,{})]})}),e.jsx(f,{control:s,name:`indexers.${d}.downloads_day`,render:({field:i})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-[10px]",children:"DLs/Day"}),e.jsx(b,{children:e.jsx(T,{type:"number",placeholder:"50",className:"h-8 text-xs",...i,onChange:w=>i.onChange(Number(w.target.value))})}),e.jsx(N,{})]})})]})]})]},o.id)}),e.jsxs("button",{type:"button",onClick:()=>a({name:"",url:"",api_path:"/api",api_key:"",type:"newznab",api_hits_day:0,downloads_day:0,username:"",password:""}),className:"flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg border-muted-foreground/25 hover:border-muted-foreground/50 hover:bg-accent/50 transition-all min-h-[250px] group",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 group-hover:bg-primary/20 transition-colors mb-4",children:e.jsx(rs,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-muted-foreground group-hover:text-foreground transition-colors",children:"Add New Indexer"}),e.jsx("div",{className:"text-xs text-muted-foreground/60 mt-1",children:"Configure another search source"})]})]})]}),r.length===0&&e.jsx("div",{className:"hidden"})]})}function za({control:s,fields:r,append:a,remove:l,watch:t}){const m=n.useMemo(()=>[...r].sort((o,d)=>{const c=t(`providers.${o.id}.priority`)??999,p=t(`providers.${d.id}.priority`)??999;return c-p}),[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.map(o=>{const d=r.findIndex(c=>c.id===o.id);return e.jsxs(q,{className:"relative flex flex-col h-full",children:[e.jsx(E,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1 h-8 w-8 text-destructive hover:text-destructive/90 z-10",onClick:()=>l(d),children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx(W,{className:"pb-3",children:e.jsxs(J,{className:"text-base truncate pr-8",children:[t(`providers.${d}.name`)||`Provider ${d+1}`,t(`providers.${d}.priority`)!=null&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(Priority: ",t(`providers.${d}.priority`),")"]})]})}),e.jsxs(U,{className:"space-y-4 flex-grow px-4 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{control:s,name:`providers.${d}.enabled`,render:({field:c})=>e.jsxs(j,{className:"flex flex-row items-center space-x-2 space-y-0",children:[e.jsx(b,{children:e.jsx(we,{checked:c.value!=null?c.value:!0,onCheckedChange:c.onChange})}),e.jsx(C,{className:"text-xs",children:"Enabled"})]})}),e.jsx(f,{control:s,name:`providers.${d}.priority`,render:({field:c})=>e.jsxs(j,{className:"w-24",children:[e.jsx(C,{className:"text-xs",children:"Priority"}),e.jsx(b,{children:e.jsx(T,{type:"number",className:"h-8 text-xs",placeholder:"1",...c,onChange:p=>c.onChange(p.target.valueAsNumber||1)})}),e.jsx(N,{})]})})]}),e.jsx(f,{control:s,name:`providers.${d}.name`,render:({field:c})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-xs",children:"Provider Name (Optional)"}),e.jsx(b,{children:e.jsx(T,{placeholder:"e.g. Newshosting",className:"h-8 text-xs",...c})}),e.jsx(N,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx(f,{control:s,name:`providers.${d}.host`,render:({field:c})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-xs",children:"Host"}),e.jsx(b,{children:e.jsx(T,{placeholder:"news.example.com",className:"h-8 text-xs",...c})}),e.jsx(N,{})]})}),e.jsx(f,{control:s,name:`providers.${d}.port`,render:({field:c})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-xs",children:"Port"}),e.jsx(b,{children:e.jsx(T,{type:"number",className:"h-8 text-xs",...c,onChange:p=>c.onChange(p.target.valueAsNumber)})}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx(f,{control:s,name:`providers.${d}.username`,render:({field:c})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-xs",children:"Username"}),e.jsx(b,{children:e.jsx(T,{className:"h-8 text-xs",...c})}),e.jsx(N,{})]})}),e.jsx(f,{control:s,name:`providers.${d}.password`,render:({field:c})=>e.jsxs(j,{children:[e.jsx(C,{className:"text-xs",children:"Password"}),e.jsx(b,{children:e.jsx(Ee,{className:"h-8 text-xs",...c})}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{control:s,name:`providers.${d}.connections`,render:({field:c})=>e.jsxs(j,{className:"w-20",children:[e.jsx(C,{className:"text-xs",children:"Conns"}),e.jsx(b,{children:e.jsx(T,{type:"number",className:"h-8 text-xs",...c,onChange:p=>c.onChange(p.target.valueAsNumber)})}),e.jsx(N,{})]})}),e.jsx(f,{control:s,name:`providers.${d}.use_ssl`,render:({field:c})=>e.jsxs(j,{className:"flex flex-row items-center space-x-2 space-y-0 h-8 mt-6",children:[e.jsx(b,{children:e.jsx(we,{checked:c.value,onCheckedChange:c.onChange})}),e.jsx(C,{className:"text-xs",children:"Use SSL"})]})})]})]})]},o.id)}),e.jsxs("button",{type:"button",onClick:()=>{const o=r.map((c,p)=>{const g=t(`providers.${p}.priority`);return g!=null&&g>0?g:0}),d=o.length>0?Math.max(...o,0):0;a({host:"",port:563,username:"",password:"",connections:30,use_ssl:!0,priority:d+1,enabled:!0})},className:"flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg border-muted-foreground/25 hover:border-muted-foreground/50 hover:bg-accent/50 transition-all min-h-[250px] group",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 group-hover:bg-primary/20 transition-colors mb-4",children:e.jsx(rs,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-muted-foreground group-hover:text-foreground transition-colors",children:"Add New Provider"}),e.jsx("div",{className:"text-xs text-muted-foreground/60 mt-1",children:"Configure another news server source"})]})]})]})})}function Ea({username:s,initialFilters:r,initialSorting:a,onConfigChange:l,formRef:t}){const m=Ds({defaultValues:{filters:r||{},sorting:a||{}}}),{watch:o,reset:d,getValues:c}=m,p=ie.useRef(l),g=ie.useRef(!0);return ie.useImperativeHandle(t,t?()=>({getValues:()=>{const i=c(),w=i.filters||{},k=i.sorting||{},L={filters:{...w},sorting:{...k}};return i.max_resolution!==void 0&&!L.filters.max_resolution&&(L.filters.max_resolution=i.max_resolution),L}}):void 0,[c,s,t]),n.useEffect(()=>{p.current=l},[l]),n.useEffect(()=>{(r||a)&&(d({filters:r||{},sorting:a||{}},{keepDefaultValues:!1}),g.current=!0)},[r,a,d,s]),n.useEffect(()=>{let i;const w=o(k=>{if(g.current){g.current=!1;return}k&&(k.filters||k.sorting)&&(clearTimeout(i),i=setTimeout(()=>{p.current(s,k)},100))});return()=>{clearTimeout(i),w.unsubscribe()}},[o,s]),e.jsxs(mr,{defaultValue:"filters",className:"w-full",children:[e.jsxs(os,{className:"mb-6 w-full grid grid-cols-2",children:[e.jsx(le,{value:"filters",className:"text-sm sm:text-base",children:"Filters"}),e.jsx(le,{value:"sorting",className:"text-sm sm:text-base",children:"Sorting"})]}),e.jsx(oe,{value:"filters",children:e.jsx(ir,{control:m.control,watch:o,fieldPrefix:"filters"})}),e.jsx(oe,{value:"sorting",children:e.jsx(dr,{control:m.control,watch:o,fieldPrefix:"sorting"})})]})}const Ia=n.forwardRef(function({globalFilters:r,globalSorting:a,sendCommand:l,ws:t},m){const[o,d]=n.useState([]),[c,p]=n.useState(!0),[g,i]=n.useState(null),[w,k]=n.useState(!1),[L,I]=n.useState(""),[P,v]=n.useState(""),[A,G]=n.useState(!1),[M,se]=n.useState(null),[ue,fe]=n.useState(""),[de,ge]=n.useState(""),[ee,Ne]=n.useState(null),[re,ae]=n.useState({}),X=ie.useRef({}),Z=ie.useRef(!1);n.useImperativeHandle(m,()=>({getDeviceConfigs:()=>{const x={};for(const[S,$]of Object.entries(X.current))if($&&$.current&&$.current.getValues){const O=$.current.getValues();O&&(O.filters||O.sorting)&&(x[S]=O)}else re[S]&&(x[S]=re[S]);return x},getUserConfigs:()=>{const x={};for(const[S,$]of Object.entries(X.current))if($&&$.current&&$.current.getValues){const O=$.current.getValues();O&&(O.filters||O.sorting)&&(x[S]=O)}else re[S]&&(x[S]=re[S]);return x}}));const Q=n.useCallback((x=!0)=>{if(!l||!t||t.readyState!==WebSocket.OPEN){I("WebSocket not connected"),x&&p(!1);return}x&&p(!0),I(""),window.deviceManagementCallback&&delete window.deviceManagementCallback,window.deviceManagementCallback=S=>{if(S.error){I(S.error),x&&p(!1),delete window.deviceManagementCallback;return}d(S),x&&p(!1),Z.current=!0,delete window.deviceManagementCallback},l("get_users",{})},[l,t]),ye=n.useCallback(()=>{l&&t&&t.readyState===WebSocket.OPEN&&(window.globalConfigCallback&&delete window.globalConfigCallback,window.globalConfigCallback=x=>{Ne(x),delete window.globalConfigCallback},l("get_config",{}))},[l,t]);n.useEffect(()=>{!Z.current&&t&&t.readyState===WebSocket.OPEN&&(Q(!0),ye())},[]),n.useEffect(()=>{!Z.current&&t&&t.readyState===WebSocket.OPEN&&l&&(Q(!0),ye())},[t?.readyState,l]);const h=ie.useRef(new Set),_=n.useCallback(x=>{if(!h.current.has(x)){if(!l||!t||t.readyState!==WebSocket.OPEN){const S={filters:r||ee?.filters||{},sorting:a||ee?.sorting||{}};ae($=>({...$,[x]:S})),h.current.add(x),X.current[x]||(X.current[x]=ie.createRef());return}window.deviceResponseCallback=S=>{const $=S.error?{filters:r||ee?.filters||{},sorting:a||ee?.sorting||{}}:{filters:S.filters||{},sorting:S.sorting||{}};ae(O=>({...O,[x]:$})),h.current.add(x),X.current[x]||(X.current[x]=ie.createRef()),delete window.deviceResponseCallback},l("get_user",{username:x})}},[l,t,r,a,ee]),K=n.useCallback(x=>{se(S=>S===x?null:(_(x),x))},[_]),V=n.useCallback((x,S)=>{ae($=>({...$,[x]:S}))},[]),D=async x=>{if(x.preventDefault(),x.stopPropagation(),I(""),v(""),k(!0),!l||!t||t.readyState!==WebSocket.OPEN){I("WebSocket not connected"),k(!1);return}window.deviceActionCallback&&delete window.deviceActionCallback,window.deviceActionCallback=S=>{k(!1),S.error?I(S.error):(v(`Device "${ue}" created successfully`),fe(""),G(!1),Q(!1)),delete window.deviceActionCallback},l("create_user",{username:ue})},R=x=>{if(x==="admin"){I("Cannot delete admin device");return}if(confirm(`Are you sure you want to delete device "${x}"?`)){if(!l||!t||t.readyState!==WebSocket.OPEN){I("WebSocket not connected");return}I(""),v(""),i(`delete-${x}`),window.deviceActionCallback&&delete window.deviceActionCallback,window.deviceActionCallback=S=>{i(null),S.error?I(S.error):(v(`Device "${x}" deleted successfully`),ae($=>{const O={...$};return delete O[x],O}),h.current.delete(x),delete X.current[x],se($=>$===x?null:$),Q(!1)),delete window.deviceActionCallback},l("delete_user",{username:x})}},F=x=>{if(!l||!t||t.readyState!==WebSocket.OPEN){I("WebSocket not connected");return}I(""),v(""),i(`regenerate-${x}`),window.deviceActionCallback&&delete window.deviceActionCallback,window.deviceActionCallback=S=>{i(null),S.error?I(S.error):(v(`Token regenerated for "${x}"`),d($=>$.map(O=>O.username===x?{...O,token:S.token}:O))),delete window.deviceActionCallback},l("regenerate_token",{username:x})},je=x=>`${ee?.addon_base_url?ee.addon_base_url.replace(/\/$/,""):window.location.origin}/${x}/manifest.json`,be=x=>{const S=je(x);navigator.clipboard.writeText(S),ge(x),setTimeout(()=>ge(""),2e3)};return e.jsxs(q,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsx(pe,{children:"Manage devices and their authentication tokens"})}),e.jsxs(er,{open:A,onOpenChange:G,children:[e.jsx(pa,{asChild:!0,children:e.jsxs(E,{type:"button",className:"w-full sm:w-auto",children:[e.jsx(rs,{className:"mr-2 h-4 w-4 shrink-0"}),"Add Device"]})}),e.jsxs(as,{children:[e.jsxs(ts,{children:[e.jsx(ns,{children:"Add New Device"}),e.jsx(ls,{children:"Create a new device account. Devices will access Stremio via their token in the URL."})]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[L&&e.jsxs("div",{className:"flex items-center gap-2 p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{children:L})]}),P&&e.jsxs("div",{className:"flex items-center gap-2 p-3 text-sm text-green-600 bg-green-50 rounded-md",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:P})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"new-username",children:"Username"}),e.jsx(T,{id:"new-username",type:"text",placeholder:"Enter username",value:ue,onChange:x=>fe(x.target.value),required:!0,disabled:w}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Devices access Stremio via their token in the URL: /","{token}","/manifest.json"]})]}),e.jsx(E,{type:"submit",className:"w-full",disabled:w,children:w?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Device"})]})]})]})]})}),e.jsxs(U,{children:[L&&!A&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 text-sm text-destructive bg-destructive/10 rounded-md",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{children:L})]}),P&&!A&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-4 text-sm text-green-600 bg-green-50 rounded-md",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:P})]}),c?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(he,{className:"h-6 w-6 animate-spin"})}):o.length===0?e.jsx("div",{className:"text-center p-8 text-muted-foreground",children:"No devices found. Create your first device to get started."}):e.jsx("div",{className:"space-y-4",children:o.map(x=>e.jsx(q,{children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("h3",{className:"font-semibold",children:x.username})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{className:"text-xs text-muted-foreground block",children:"Stremio URL:"}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsx("code",{className:"text-xs bg-muted px-2 py-1.5 rounded break-all min-w-0",children:je(x.token)}),e.jsxs(E,{type:"button",variant:"ghost",size:"sm",onClick:()=>be(x.token),className:"h-8 shrink-0 self-start sm:self-center",title:"Copy manifest URL",children:[de===x.token?e.jsx(ve,{className:"h-4 w-4 sm:mr-1"}):e.jsx(ta,{className:"h-4 w-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:de===x.token?"Copied":"Copy"})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 sm:shrink-0 sm:ml-4",children:[x.username!=="admin"&&e.jsx(E,{type:"button",variant:M===x.username?"default":"outline",size:"sm",onClick:()=>K(x.username),disabled:g!==null||c,className:"flex-1 min-w-[7rem] sm:flex-none",children:M===x.username?e.jsxs(e.Fragment,{children:[e.jsx(na,{className:"h-3 w-3 mr-1 shrink-0"}),e.jsx("span",{className:"truncate",children:"Hide Config"})]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-3 w-3 mr-1 shrink-0"}),e.jsx("span",{className:"truncate",children:"Configure"})]})}),e.jsxs(E,{type:"button",variant:"outline",size:"sm",onClick:()=>F(x.username),disabled:g!==null||c,className:"flex-1 min-w-[7rem] sm:flex-none",children:[g===`regenerate-${x.username}`?e.jsx(he,{className:"h-3 w-3 mr-1 shrink-0 animate-spin"}):e.jsx(la,{className:"h-3 w-3 mr-1 shrink-0"}),e.jsx("span",{className:"truncate hidden sm:inline",children:"Regenerate Token"}),e.jsx("span",{className:"truncate sm:hidden",children:"Regenerate"})]}),x.username!=="admin"&&e.jsxs(E,{type:"button",variant:"destructive",size:"sm",onClick:()=>R(x.username),disabled:g!==null||c,className:"flex-1 min-w-[7rem] sm:flex-none",children:[g===`delete-${x.username}`?e.jsx(he,{className:"h-3 w-3 shrink-0 animate-spin"}):e.jsx(ss,{className:"h-3 w-3 shrink-0"}),e.jsx("span",{className:"ml-1",children:"Delete"})]})]})]}),x.username!=="admin"&&M===x.username&&re[x.username]&&(X.current[x.username]||(X.current[x.username]=ie.createRef()),e.jsx("div",{className:"pt-4 border-t",children:e.jsx(Ea,{username:x.username,initialFilters:re[x.username]?.filters,initialSorting:re[x.username]?.sorting,onConfigChange:V,formRef:X.current[x.username]})}))]})})},x.username))})]})]})});function ke({show:s}){return s?e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-500 flex items-center gap-1 mt-1",children:[e.jsx($e,{className:"h-3.5 w-3 shrink-0"}),"Overwritten by environment variable on restart."]}):null}function $a({initialConfig:s,sendCommand:r,saveStatus:a,isSaving:l,onClose:t,adminToken:m}){const[o,d]=n.useState(!s),[c,p]=n.useState("general"),[g,i]=n.useState(!1),[w,k]=n.useState(null),L=n.useRef(null),I=n.useRef(null),P=Ds({defaultValues:{admin_username:"admin",admin_password:"",addon_port:7e3,addon_base_url:"",log_level:"INFO",proxy_enabled:!1,proxy_port:119,proxy_host:"",proxy_auth_user:"",proxy_auth_pass:"",cache_ttl_seconds:300,validation_sample_size:5,max_streams:6,max_streams_per_resolution:0,providers:[],indexers:[],filters:{allowed_qualities:[],blocked_qualities:[],min_resolution:"",max_resolution:"",allowed_codecs:[],blocked_codecs:[],required_audio:[],allowed_audio:[],min_channels:"",require_hdr:!1,allowed_hdr:[],blocked_hdr:[],block_sdr:!1,required_languages:[],allowed_languages:[],block_dubbed:!1,block_cam:!1,require_proper:!1,allow_repack:!0,block_hardcoded:!1,min_bit_depth:"",min_size_gb:0,max_size_gb:0,blocked_groups:[]},sorting:{resolution_weights:{"4k":4e6,"1080p":3e6,"720p":2e6,sd:1e6},codec_weights:{HEVC:1e3,x265:1e3,x264:500,AVC:500},audio_weights:{Atmos:1500,TrueHD:1200,"DTS-HD":1e3,"DTS-X":1e3,DTS:500,"DD+":400,DD:300,AC3:200,"5.1":500,"7.1":1e3},quality_weights:{BluRay:2e3,"WEB-DL":1500,WEBRip:1200,HDTV:1e3,"Blu-ray":2e3},visual_tag_weights:{DV:1500,"HDR10+":1200,HDR:1e3,"3D":800},grab_weight:.5,age_weight:1,preferred_groups:[],preferred_languages:[]}}}),v=s?.env_overrides??[],{control:A,handleSubmit:G,reset:M,setError:se,formState:ue,setValue:fe,watch:de,getValues:ge}=P,{fields:ee,append:Ne,remove:re}=us({control:A,name:"providers"}),{fields:ae,append:X,remove:Z}=us({control:A,name:"indexers"});n.useEffect(()=>{if(s){const h={resolution_weights:{"4k":4e6,"1080p":3e6,"720p":2e6,sd:1e6},codec_weights:{HEVC:1e3,x265:1e3,x264:500,AVC:500},audio_weights:{Atmos:1500,TrueHD:1200,"DTS-HD":1e3,"DTS-X":1e3,DTS:500,"DD+":400,DD:300,AC3:200,"5.1":500,"7.1":1e3},quality_weights:{BluRay:2e3,"WEB-DL":1500,WEBRip:1200,HDTV:1e3,"Blu-ray":2e3},visual_tag_weights:{DV:1500,"HDR10+":1200,HDR:1e3,"3D":800},grab_weight:.5,age_weight:1,preferred_groups:[],preferred_languages:[]},_={allowed_qualities:[],blocked_qualities:[],min_resolution:"",max_resolution:"",allowed_codecs:[],blocked_codecs:[],required_audio:[],allowed_audio:[],min_channels:"",require_hdr:!1,allowed_hdr:[],blocked_hdr:[],block_sdr:!1,required_languages:[],allowed_languages:[],block_dubbed:!1,block_cam:!1,require_proper:!1,allow_repack:!0,block_hardcoded:!1,min_bit_depth:"",min_size_gb:0,max_size_gb:0,blocked_groups:[]},{env_overrides:K,...V}=s,D={...V,admin_username:s.admin_username||"admin",admin_password:"",addon_port:Number(s.addon_port),proxy_port:Number(s.proxy_port),cache_ttl_seconds:Number(s.cache_ttl_seconds),validation_sample_size:Number(s.validation_sample_size),max_concurrent_validations:Number(s.max_concurrent_validations),max_streams_per_resolution:Number(s.max_streams_per_resolution||0),providers:s.providers?.map((R,F)=>({...R,priority:R.priority!=null?R.priority:F+1,enabled:R.enabled!=null?R.enabled:!0,port:Number(R.port),connections:Number(R.connections)}))||[],indexers:s.indexers?.map(R=>({...R,api_path:R.api_path||"/api",api_hits_day:Number(R.api_hits_day||0),downloads_day:Number(R.downloads_day||0),username:R.username||"",password:R.password||""}))||[],sorting:{...h,...s.sorting||{},resolution_weights:{...h.resolution_weights,...s.sorting?.resolution_weights||{}},codec_weights:{...h.codec_weights,...s.sorting?.codec_weights||{}},audio_weights:{...h.audio_weights,...s.sorting?.audio_weights||{}},quality_weights:{...h.quality_weights,...s.sorting?.quality_weights||{}},visual_tag_weights:{...h.visual_tag_weights,...s.sorting?.visual_tag_weights||{}},grab_weight:s.sorting?.grab_weight??h.grab_weight,age_weight:s.sorting?.age_weight??h.age_weight,preferred_groups:s.sorting?.preferred_groups||h.preferred_groups,preferred_languages:s.sorting?.preferred_languages||h.preferred_languages},filters:{..._,...s.filters||{},allowed_qualities:s.filters?.allowed_qualities||_.allowed_qualities,blocked_qualities:s.filters?.blocked_qualities||_.blocked_qualities,allowed_codecs:s.filters?.allowed_codecs||_.allowed_codecs,blocked_codecs:s.filters?.blocked_codecs||_.blocked_codecs,required_audio:s.filters?.required_audio||_.required_audio,allowed_audio:s.filters?.allowed_audio||_.allowed_audio,required_languages:s.filters?.required_languages||_.required_languages,allowed_languages:s.filters?.allowed_languages||_.allowed_languages,allowed_hdr:s.filters?.allowed_hdr||_.allowed_hdr,blocked_hdr:s.filters?.blocked_hdr||_.blocked_hdr,blocked_groups:s.filters?.blocked_groups||_.blocked_groups}};M(D),k(JSON.stringify(D)),i(!1),d(!1)}},[s,M]),n.useEffect(()=>{const h=de(_=>{const K=JSON.stringify(_);i(!!(w&&K!==w))});return()=>h.unsubscribe()},[de,w]),n.useEffect(()=>{a.errors&&Object.keys(a.errors).forEach(h=>{se(h,{type:"server",message:a.errors[h]})})},[a.errors,se]);const Q=async h=>{try{if(L.current){const D=L.current.getDeviceConfigs();if(Object.keys(D).length>0){const R={},F=h.admin_username||"admin";for(const[je,be]of Object.entries(D))je===F||!be||(R[je]={filters:be.filters||{},sorting:be.sorting||{}});Object.keys(R).length>0&&r("save_user_configs",R)}}const _=D=>{if(typeof D!="object"||D===null)return D;if(Array.isArray(D))return D.map(F=>_(F));const R={};for(const F in D)typeof D[F]=="string"?R[F]=D[F].trim():typeof D[F]=="object"?R[F]=_(D[F]):R[F]=D[F];return R},K=_(h),V=K.admin_password;if(delete K.admin_password,V){I.current=K;const D=window.deviceActionCallback;window.deviceActionCallback=R=>{if(R.success!==void 0||R.error&&!R.token&&!R.user){D&&D(R),R.error?se("admin_password",{type:"server",message:R.error}):(fe("admin_password",""),r("save_config",I.current),i(!1),k(JSON.stringify(I.current))),I.current=null,window.deviceActionCallback=D||void 0,D||delete window.deviceActionCallback;return}D&&D(R)},r("update_password",{username:K.admin_username||"admin",password:V});return}r("save_config",K),i(!1),k(JSON.stringify(K))}catch(_){console.error("Error saving configuration:",_),se("root",{message:"Failed to save configuration: "+_.message})}},ye=h=>{!h&&g?confirm("You have unsaved changes. Are you sure you want to close without saving?")&&(t(),i(!1)):h||t()};return o?null:e.jsx(er,{open:!0,onOpenChange:ye,children:e.jsxs(as,{className:"max-w-[90vw] h-[90vh] flex flex-col p-0 gap-0 overflow-hidden [&>*]:overflow-visible",children:[e.jsxs(ts,{className:"p-6 pb-4 border-b shrink-0",children:[e.jsx(ns,{children:"Configuration"}),e.jsx(ls,{children:"Configure your indexers and Usenet providers."})]}),e.jsxs(mr,{value:c,onValueChange:p,className:"w-full flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"px-6 pt-4 pb-2 border-b shrink-0",children:[e.jsx("div",{className:"hidden md:block",children:e.jsxs(os,{className:"flex w-full bg-muted/50 p-1",children:[e.jsx(le,{value:"general",className:"flex-1",children:"General"}),e.jsx(le,{value:"indexers",className:"flex-1",children:"Indexers"}),e.jsx(le,{value:"providers",className:"flex-1",children:"Providers"}),e.jsx(le,{value:"filters",className:"flex-1",children:"Filters"}),e.jsx(le,{value:"sorting",className:"flex-1",children:"Sorting"}),e.jsx(le,{value:"devices",className:"flex-1",children:"Devices"}),e.jsx(le,{value:"advanced",className:"flex-1",children:"Advanced"})]})}),e.jsx("div",{className:"md:hidden",children:e.jsxs(Xe,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"w-full justify-between bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"capitalize",children:c})]}),e.jsx(Ge,{className:"h-4 w-4 opacity-50"})]})}),e.jsxs(Fe,{className:"w-[calc(100vw-5rem)]",children:[e.jsx(te,{onClick:()=>p("general"),children:"General"}),e.jsx(te,{onClick:()=>p("indexers"),children:"Indexers"}),e.jsx(te,{onClick:()=>p("providers"),children:"Providers"}),e.jsx(te,{onClick:()=>p("filters"),children:"Filters"}),e.jsx(te,{onClick:()=>p("sorting"),children:"Sorting"}),e.jsx(te,{onClick:()=>p("devices"),children:"Devices"}),e.jsx(te,{onClick:()=>p("advanced"),children:"Advanced"})]})]})})]}),e.jsx(tr,{className:"flex-1 min-h-0 w-full",children:e.jsx("div",{className:"p-6",children:e.jsx(ja,{...P,children:e.jsxs("form",{onSubmit:G(Q),children:[e.jsxs(oe,{value:"general",className:"space-y-6 mt-0",children:[e.jsxs(q,{className:"border-border/80 shadow-sm",children:[e.jsxs(W,{className:"pb-4",children:[e.jsx(J,{className:"text-xl font-semibold tracking-tight",children:"Addon Settings"}),e.jsx(pe,{className:"text-muted-foreground mt-1",children:"Configure how the Stremio addon listens and is accessed."})]}),e.jsxs(U,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:A,name:"addon_base_url",render:({field:h})=>e.jsxs(j,{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium",children:"Base URL"}),e.jsx(b,{children:e.jsx(T,{placeholder:"http://localhost:7000",className:"h-10 bg-muted/30 border-border/80 focus-visible:ring-2 focus-visible:ring-ring/50",...h})}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("addon_base_url")})]})}),e.jsx(f,{control:A,name:"addon_port",render:({field:h})=>e.jsxs(j,{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium",children:"Port (Requires Restart)"}),e.jsx(b,{children:e.jsx(T,{type:"number",className:"h-10 bg-muted/30 border-border/80 focus-visible:ring-2 focus-visible:ring-ring/50",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("addon_port")})]})})]}),e.jsx(ar,{className:"my-6"}),e.jsxs("div",{className:"rounded-lg border border-border/60 bg-muted/20 p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Dashboard credentials"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Username and password to log in to this dashboard. Save changes to apply. Leave password blank to keep the current one."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(f,{control:A,name:"admin_username",render:({field:h})=>e.jsxs(j,{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium",children:"Username"}),e.jsx(b,{children:e.jsx(T,{placeholder:"admin",className:"h-10 bg-muted/30 border-border/80 focus-visible:ring-2 focus-visible:ring-ring/50",...h})}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("admin_username")})]})}),e.jsx(f,{control:A,name:"admin_password",render:({field:h})=>e.jsxs(j,{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium",children:"New password"}),e.jsx(b,{children:e.jsx(T,{type:"password",placeholder:"Leave blank to keep current",className:"h-10 bg-muted/30 border-border/80 focus-visible:ring-2 focus-visible:ring-ring/50",...h})}),e.jsx(N,{})]})})]})]})]})]}),e.jsxs(q,{children:[e.jsxs(W,{children:[e.jsx(J,{className:"text-lg",children:"NNTP Proxy Server"}),e.jsx(pe,{children:"Allow other apps (SABnzbd, NZBGet) to use StreamNZB as a localized news server."}),(v.includes("proxy_enabled")||v.includes("proxy_port")||v.includes("proxy_host")||v.includes("proxy_auth_user")||v.includes("proxy_auth_pass"))&&e.jsxs("p",{className:"text-xs text-amber-600 dark:text-amber-500 flex items-center gap-1 mt-1",children:[e.jsx($e,{className:"h-3.5 w-3 shrink-0"}),"Some settings overwritten by environment variables (NNTP_PROXY_*) on restart."]})]}),e.jsxs(U,{className:"grid gap-4",children:[e.jsx(f,{control:A,name:"proxy_enabled",render:({field:h})=>e.jsxs(j,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(C,{className:"text-base",children:"Enable Proxy"})}),e.jsx(b,{children:e.jsx(we,{checked:h.value,onCheckedChange:h.onChange})})]})}),P.watch("proxy_enabled")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:A,name:"proxy_host",render:({field:h})=>e.jsxs(j,{children:[e.jsx(C,{children:"Bind Host"}),e.jsx(b,{children:e.jsx(T,{placeholder:"0.0.0.0",...h})}),e.jsx(N,{})]})}),e.jsx(f,{control:A,name:"proxy_port",render:({field:h})=>e.jsxs(j,{children:[e.jsx(C,{children:"Port"}),e.jsx(b,{children:e.jsx(T,{type:"number",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(N,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:A,name:"proxy_auth_user",render:({field:h})=>e.jsxs(j,{children:[e.jsx(C,{children:"Proxy Username"}),e.jsx(b,{children:e.jsx(T,{...h})}),e.jsx(N,{})]})}),e.jsx(f,{control:A,name:"proxy_auth_pass",render:({field:h})=>e.jsxs(j,{children:[e.jsx(C,{children:"Proxy Password"}),e.jsx(b,{children:e.jsx(Ee,{...h})}),e.jsx(N,{})]})})]})]})]})]})]}),e.jsxs(oe,{value:"indexers",className:"space-y-6",children:[v.includes("indexers")&&e.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950/40 p-3",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4 shrink-0"}),"Indexer list is overwritten by environment variables (INDEXER_1_*, etc.) on restart."]})}),e.jsx(Aa,{control:A,indexerFields:ae,appendIndexer:X,removeIndexer:Z,watch:de,setValue:fe})]}),e.jsx(oe,{value:"advanced",className:"space-y-6",children:e.jsxs(q,{children:[e.jsx(W,{children:e.jsx(J,{className:"text-lg",children:"Advanced Settings"})}),e.jsxs(U,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(f,{control:A,name:"log_level",render:({field:h})=>e.jsxs(j,{children:[e.jsx(C,{children:"Log Level"}),e.jsx("div",{className:"relative w-full",children:e.jsxs("select",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",...h,children:[e.jsx("option",{value:"DEBUG",children:"DEBUG"}),e.jsx("option",{value:"INFO",children:"INFO"}),e.jsx("option",{value:"WARN",children:"WARN"}),e.jsx("option",{value:"ERROR",children:"ERROR"})]})}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("log_level")})]})}),e.jsx(f,{control:A,name:"cache_ttl_seconds",render:({field:h})=>e.jsxs(j,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:["Cache TTL (seconds)",e.jsx(Te,{children:e.jsxs(Pe,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(Ce,{className:"max-w-xs",children:e.jsx("p",{children:"How long to cache validation results. Cached results avoid re-checking the same NZB files repeatedly, improving performance."})})]})})]}),e.jsx(b,{children:e.jsx(T,{type:"number",min:"60",max:"3600",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(Y,{children:"Cache duration in seconds (default: 300)"}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("cache_ttl_seconds")})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsx(f,{control:A,name:"validation_sample_size",render:({field:h})=>e.jsxs(j,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:["Validation Sample Size",e.jsx(Te,{children:e.jsxs(Pe,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(Ce,{className:"max-w-xs",children:e.jsx("p",{children:"Number of segments to check from each NZB file. Samples first, last, and evenly distributed segments. Higher values = more accurate validation but slower."})})]})})]}),e.jsx(b,{children:e.jsx(T,{type:"number",min:"1",max:"20",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(Y,{children:"Segments to check per NZB (default: 5)"}),e.jsx(N,{}),e.jsx(ke,{show:v.includes("validation_sample_size")})]})}),e.jsx(f,{control:A,name:"max_streams",render:({field:h})=>e.jsxs(j,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:["Max Streams",e.jsx(Te,{children:e.jsxs(Pe,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(Ce,{className:"max-w-xs",children:e.jsx("p",{children:"Maximum number of successful streams to return per search. The system will validate up to 2x this number of releases to find healthy ones. Higher values provide more options but take longer."})})]})})]}),e.jsx(b,{children:e.jsx(T,{type:"number",min:"1",max:"20",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(Y,{children:"Number of streams to return (default: 6)"}),e.jsx(N,{})]})}),e.jsx(f,{control:A,name:"max_streams_per_resolution",render:({field:h})=>e.jsxs(j,{children:[e.jsxs(C,{className:"flex items-center gap-2",children:["Max Streams per Resolution",e.jsx(Te,{children:e.jsxs(Pe,{children:[e.jsx(Ae,{asChild:!0,children:e.jsx(Re,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(Ce,{className:"max-w-xs",children:e.jsx("p",{children:"Limit the number of streams returned per resolution (4K, 1080p, 720p, SD). Set to 0 to disable and use Max Streams behavior instead. Useful when you want multiple resolution options but don't want all streams at the highest resolution."})})]})})]}),e.jsx(b,{children:e.jsx(T,{type:"number",min:"0",max:"10",...h,onChange:_=>h.onChange(_.target.valueAsNumber)})}),e.jsx(Y,{children:"Max streams per resolution (0 = disabled, default: 0)"}),e.jsx(N,{})]})})]})]})]})}),e.jsxs(oe,{value:"providers",className:"space-y-6",children:[v.includes("providers")&&e.jsx("div",{className:"rounded-lg border border-amber-200 bg-amber-50 dark:border-amber-900 dark:bg-amber-950/40 p-3",children:e.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4 shrink-0"}),"Provider list is overwritten by environment variables (PROVIDER_1_*, etc.) on restart."]})}),e.jsx(za,{control:A,fields:ee,append:Ne,remove:re,watch:de})]}),e.jsx(oe,{value:"filters",className:"space-y-6",children:e.jsx(ir,{control:A,watch:P.watch})}),e.jsx(oe,{value:"sorting",className:"space-y-6",children:e.jsx(dr,{control:A,watch:P.watch})}),e.jsx(oe,{value:"devices",className:"space-y-6",children:e.jsx(Ia,{ref:L,globalFilters:ge("filters"),globalSorting:ge("sorting"),sendCommand:r,ws:window.ws})})]})})})})]}),e.jsxs(rr,{className:"p-6 pt-4 border-t gap-2 sm:justify-between shrink-0",children:[e.jsx("div",{className:`flex items-center text-sm ${a.type==="error"?"text-destructive":a.type==="success"?"text-green-500":"text-muted-foreground"}`,children:a.msg}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{type:"button",variant:"destructive",onClick:()=>{if(confirm("Are you sure you want to restart StreamNZB?")){const h=window.location.port||(window.location.protocol==="https:"?"443":"80"),_=P.getValues("addon_port").toString(),K=window.location.hostname,D=`${window.location.protocol}//${K}:${_}/`;r("restart",{}),_!==h&&setTimeout(()=>{window.location.href=D},3e3)}},children:[e.jsx(oa,{className:"mr-2 h-4 w-4"}),"Restart App"]}),e.jsxs(E,{type:"button",onClick:G(Q),disabled:l||ue.isSubmitting,children:[(l||ue.isSubmitting)&&e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})]})})}function La({onLogin:s,version:r}){const[a,l]=n.useState(""),[t,m]=n.useState(""),[o,d]=n.useState(""),[c,p]=n.useState(!1),g=async i=>{i.preventDefault(),d(""),p(!0);try{const k=await(await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:a,password:t})})).json();k.success?(k.token&&localStorage.setItem("auth_token",k.token),s(k.user,k.token,k.must_change_password||!1)):d(k.error||"Login failed")}catch{d("Failed to connect to server")}finally{p(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background p-4",children:[r&&e.jsxs("p",{className:"absolute top-4 left-1/2 -translate-x-1/2 text-sm text-muted-foreground",children:["StreamNZB v",r]}),e.jsxs(q,{className:"w-full max-w-md",children:[e.jsxs(W,{className:"space-y-1",children:[e.jsx(J,{className:"text-2xl font-bold",children:"Login"}),e.jsx(pe,{children:"Enter your credentials to access StreamNZB"})]}),e.jsx(U,{children:e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[o&&e.jsxs("div",{className:"flex items-center gap-2 p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{children:o})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"username",children:"Username"}),e.jsx(T,{id:"username",type:"text",placeholder:"Enter your username",value:a,onChange:i=>l(i.target.value),required:!0,autoFocus:!0,disabled:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"password",children:"Password"}),e.jsx(T,{id:"password",type:"password",placeholder:"Enter your password",value:t,onChange:i=>m(i.target.value),required:!0,disabled:c})]}),e.jsx(E,{type:"submit",className:"w-full",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),"Logging in..."]}):"Login"})]})})]})]})}function Oa({username:s,onPasswordChanged:r}){const[a,l]=n.useState(""),[t,m]=n.useState(""),[o,d]=n.useState(""),[c,p]=n.useState(""),[g,i]=n.useState(!1),[w,k]=n.useState(null);n.useEffect(()=>{const P=()=>{if(window.ws&&window.ws.readyState===WebSocket.OPEN){k(window.ws);return}setTimeout(P,100)};P()},[]);const L=(P,v)=>w&&w.readyState===WebSocket.OPEN?(w.send(JSON.stringify({type:P,payload:v})),!0):!1,I=async P=>{if(P.preventDefault(),p(""),t!==o){p("New passwords do not match");return}if(t.length<6){p("Password must be at least 6 characters long");return}if(!w||w.readyState!==WebSocket.OPEN){p("WebSocket not connected. Please wait...");return}i(!0);try{const v=localStorage.getItem("auth_token")||"",G=await(await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:s,password:a})})).json();if(!G.success){p("Current password is incorrect"),i(!1);return}window.passwordChangeCallback=M=>{i(!1),M.error?p(M.error):(G.token&&localStorage.setItem("auth_token",G.token),r()),delete window.passwordChangeCallback},L("update_password",{username:s,password:t})||(p("Failed to send update request"),i(!1),delete window.passwordChangeCallback)}catch{p("Failed to connect to server"),i(!1),delete window.passwordChangeCallback}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs(q,{className:"w-full max-w-md",children:[e.jsxs(W,{className:"space-y-1",children:[e.jsx(J,{className:"text-2xl font-bold",children:"Change Password"}),e.jsx(pe,{children:"You must change your password before continuing"})]}),e.jsx(U,{children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[c&&e.jsxs("div",{className:"flex items-center gap-2 p-3 text-sm text-destructive bg-destructive/10 rounded-md",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"current-password",children:"Current Password"}),e.jsx(T,{id:"current-password",type:"password",placeholder:"Enter current password",value:a,onChange:P=>l(P.target.value),required:!0,autoFocus:!0,disabled:g})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"new-password",children:"New Password"}),e.jsx(T,{id:"new-password",type:"password",placeholder:"Enter new password (min 6 characters)",value:t,onChange:P=>m(P.target.value),required:!0,disabled:g})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ce,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsx(T,{id:"confirm-password",type:"password",placeholder:"Confirm new password",value:o,onChange:P=>d(P.target.value),required:!0,disabled:g})]}),e.jsx(E,{type:"submit",className:"w-full",disabled:g,children:g?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"mr-2 h-4 w-4 animate-spin"}),"Changing password..."]}):"Change Password"})]})})]})})}const Fa={light:"",dark:".dark"},ur=n.createContext(null);function xr(){const s=n.useContext(ur);if(!s)throw new Error("useChart must be used within a <ChartContainer />");return s}const Ke=n.forwardRef(({id:s,className:r,children:a,config:l,...t},m)=>{const o=n.useId(),d=`chart-${s||o.replace(/:/g,"")}`;return e.jsx(ur.Provider,{value:{config:l},children:e.jsxs("div",{"data-chart":d,ref:m,className:y("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",r),...t,children:[e.jsx(Ba,{id:d,config:l}),e.jsx(ma,{children:a})]})})});Ke.displayName="Chart";const Ba=({id:s,config:r})=>{const a=Object.entries(r).filter(([,l])=>l.theme||l.color);return a.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(Fa).map(([l,t])=>`
${t} [data-chart=${s}] {
${a.map(([m,o])=>{const d=o.theme?.[l]||o.color;return d?`  --color-${m}: ${d};`:null}).join(`
`)}
}
`).join(`
`)}}):null},ks=ua,Je=n.forwardRef(({active:s,payload:r,className:a,indicator:l="dot",hideLabel:t=!1,hideIndicator:m=!1,label:o,labelFormatter:d,labelClassName:c,formatter:p,color:g,nameKey:i,labelKey:w},k)=>{const{config:L}=xr(),I=n.useMemo(()=>{if(t||!r?.length)return null;const[v]=r,A=`${w||v?.dataKey||v?.name||"value"}`,G=Qe(L,v,A),M=!w&&typeof o=="string"?L[o]?.label||o:G?.label;return d?e.jsx("div",{className:y("font-medium",c),children:d(M,r)}):M?e.jsx("div",{className:y("font-medium",c),children:M}):null},[o,d,r,t,c,L,w]);if(!s||!r?.length)return null;const P=r.length===1&&l!=="dot";return e.jsxs("div",{ref:k,className:y("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[P?null:I,e.jsx("div",{className:"grid gap-1.5",children:r.filter(v=>v.type!=="none").map((v,A)=>{const G=`${i||v.name||v.dataKey||"value"}`,M=Qe(L,v,G),se=g||v.payload.fill||v.color;return e.jsx("div",{className:y("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",l==="dot"&&"items-center"),children:p&&v?.value!==void 0&&v.name?p(v.value,v.name,v,A,v.payload):e.jsxs(e.Fragment,{children:[M?.icon?e.jsx(M.icon,{}):!m&&e.jsx("div",{className:y("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":l==="dot","w-1":l==="line","w-0 border-[1.5px] border-dashed bg-transparent":l==="dashed","my-0.5":P&&l==="dashed"}),style:{"--color-bg":se,"--color-border":se}}),e.jsxs("div",{className:y("flex flex-1 justify-between leading-none",P?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[P?I:null,e.jsx("span",{className:"text-muted-foreground",children:M?.label||v.name})]}),v.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:v.value.toLocaleString()})]})]})},v.dataKey)})})]})});Je.displayName="ChartTooltip";const Ma=n.forwardRef(({className:s,hideIcon:r=!1,payload:a,verticalAlign:l="bottom",nameKey:t},m)=>{const{config:o}=xr();return a?.length?e.jsx("div",{ref:m,className:y("flex items-center justify-center gap-4",l==="top"?"pb-3":"pt-3",s),children:a.filter(d=>d.type!=="none").map(d=>{const c=`${t||d.dataKey||"value"}`,p=Qe(o,d,c);return e.jsxs("div",{className:y("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[p?.icon&&!r?e.jsx(p.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:d.color}}),p?.label]},d.value)})}):null});Ma.displayName="ChartLegend";function Qe(s,r,a){if(typeof r!="object"||r===null)return;const l="payload"in r&&typeof r.payload=="object"&&r.payload!==null?r.payload:void 0;let t=a;return a in r&&typeof r[a]=="string"?t=r[a]:l&&a in l&&typeof l[a]=="string"&&(t=l[a]),t in s?s[t]:s[a]}const Cs={speed:{label:"Speed",color:"hsl(var(--chart-1))"},conns:{label:"Connections",color:"hsl(var(--chart-2))"}},Ss=s=>e.jsx("svg",{role:"img",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",...s,children:e.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.418 2.157-2.418 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.418 2.157-2.418 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})});function Va(){const[s,r]=n.useState(!1),[a,l]=n.useState(null),[t,m]=n.useState(localStorage.getItem("auth_token")||""),[o,d]=n.useState(!1),[c,p]=n.useState(null),[g,i]=n.useState(null),[w,k]=n.useState({type:"",msg:"",errors:null}),[L,I]=n.useState(!1),[P,v]=n.useState(!1),A=n.useRef(!1),[G,M]=n.useState(null),[se,ue]=n.useState([]),[fe,de]=n.useState([]),[ge,ee]=n.useState(!1),[Ne,re]=n.useState("connecting"),[ae,X]=n.useState(null),[Z,Q]=n.useState(localStorage.getItem("theme")||"system"),[ye,h]=n.useState(!1),[_,K]=n.useState(null),V=n.useRef(!1),D=n.useRef(null),[R,F]=n.useState([]),je=n.useRef(null);n.useEffect(()=>{fetch("/api/info").then(u=>u.ok?u.json():null).then(u=>u?.version&&K(u.version)).catch(()=>{})},[]),n.useEffect(()=>{const u=localStorage.getItem("auth_token");if(u)V.current=!1,m(u),r(!0),D.current=setTimeout(()=>{s&&!a&&Ne!=="connected"&&(r(!1),m(""),localStorage.removeItem("auth_token"))},5e3);else{const B=window.location.pathname.split("/").filter(xe=>xe!=="");B.length>0&&B[0]!=="api"?(V.current=!1,r(!0),l("legacy")):r(!1)}return()=>{D.current&&clearTimeout(D.current)}},[]);const be=(u,B,xe)=>{V.current=!1,r(!0),l(u),m(B),d(xe),localStorage.setItem("auth_token",B)},x=()=>{V.current=!0,r(!1),l(null),m(""),localStorage.removeItem("auth_token"),ae&&ae.close(),X(null),window.ws=null};n.useEffect(()=>{const u=window.document.documentElement;if(u.classList.remove("light","dark"),Z==="system"){const B=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";u.classList.add(B)}else u.classList.add(Z);localStorage.setItem("theme",Z)},[Z]),n.useEffect(()=>{if(!s||V.current)return;let u,B;const xe=()=>{if(V.current)return;const hr=window.location.protocol==="https:"?"wss:":"ws:",pr=window.location.host,_e=window.location.pathname.split("/").filter(Me=>Me!==""),fr=_e.length>0&&_e[0]!=="api"?`/${_e[0]}`:"",cs=t||(_e.length>0&&_e[0]!=="api"?_e[0]:""),gr=`${hr}//${pr}${fr}/api/ws${cs?`?token=${cs}`:""}`;u=new WebSocket(gr),u.onopen=()=>{if(A.current){window.location.reload();return}if(V.current){u.close();return}re("connected"),M(null),X(u),window.ws=u,F([])},u.onmessage=Me=>{if(V.current)return;const H=JSON.parse(Me.data);switch(H.type){case"stats":{const Se=H.payload;p(Se);const ds=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"});ue(Ve=>[...Ve,{time:ds,speed:Se.total_speed_mbps}].slice(-60)),de(Ve=>[...Ve,{time:ds,conns:Se.active_connections}].slice(-60));break}case"config":{i(H.payload),window.globalConfigCallback&&window.globalConfigCallback(H.payload);break}case"log_entry":{F(Se=>[...Se,H.payload].slice(-200));break}case"log_history":{F(H.payload.slice(-200));break}case"save_status":{k({type:H.payload.status==="success"?"success":"error",msg:H.payload.message,errors:H.payload.errors}),I(!1);break}case"auth_info":{if(H.payload?.version&&K(H.payload.version),V.current){u.close();return}H.payload.authenticated?(D.current&&(clearTimeout(D.current),D.current=null),r(!0),l(H.payload.username),d(H.payload.must_change_password||!1)):(D.current&&(clearTimeout(D.current),D.current=null),V.current=!1,r(!1),l(null),m(""),localStorage.removeItem("auth_token"),u.close());break}case"users_response":{window.deviceManagementCallback&&window.deviceManagementCallback(H.payload);break}case"user_response":{window.deviceResponseCallback&&window.deviceResponseCallback(H.payload);break}case"user_action_response":{window.deviceActionCallback&&window.deviceActionCallback(H.payload),window.passwordChangeCallback&&window.passwordChangeCallback(H.payload);break}}},u.onclose=()=>{re("disconnected"),X(null),window.ws=null,V.current||(B=setTimeout(()=>{s&&!V.current&&xe()},3e3))},u.onerror=()=>{M("Network Error: Could not connect to API"),t&&s&&!a&&(r(!1),m(""),localStorage.removeItem("auth_token")),u.close()}};return xe(),()=>{u&&u.close(),B&&clearTimeout(B)}},[s,t]);const S=(u,B)=>{ae&&ae.readyState===WebSocket.OPEN&&(u==="save_config"||u==="save_user_configs"?(k({type:"normal",msg:"Validating and saving...",errors:null}),I(!0)):u==="restart"&&(v(!0),A.current=!0),ae.send(JSON.stringify({type:u,payload:B})))},$=()=>{if(!g)return"#";let B=(g.addon_base_url||window.location.origin).replace(/\/$/,"");return a&&a!=="legacy"&&t?`${B}/${t}/manifest.json`:`${B}/manifest.json`},O=u=>{const B=$();if(u==="web"){const xe=encodeURIComponent(B);window.open(`https://web.stremio.com/#/addons?addon=${xe}`,"_blank")}else u==="copy"&&navigator.clipboard.writeText(B).then(()=>{is(!0),setTimeout(()=>is(!1),2e3)})},[Ie,is]=n.useState(!1);return s?o&&a?e.jsx(Oa,{username:a,onPasswordChanged:()=>{d(!1)}}):G&&Ne==="disconnected"?e.jsxs("div",{className:"flex flex-col h-screen items-center justify-center gap-4",children:[e.jsx(ze,{className:"h-12 w-12 text-destructive animate-pulse"}),e.jsx("div",{className:"text-xl font-semibold text-destructive",children:G}),e.jsx("p",{className:"text-muted-foreground",children:"Retrying connection..."})]}):!c||P?e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-background/80 backdrop-blur-sm gap-4",children:[e.jsx(he,{className:"h-12 w-12 text-primary animate-spin"}),e.jsx("div",{className:"text-xl font-semibold tracking-tight",children:P?"Restarting StreamNZB...":"Initializing StreamNZB Dashboard..."}),P&&e.jsx("p",{className:"text-muted-foreground animate-pulse",children:"Redirecting to home shortly..."})]}):e.jsxs("div",{className:"min-h-screen bg-background text-foreground p-4 md:p-8",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsx(E,{variant:"ghost",size:"icon",className:"md:hidden h-9 w-9",onClick:()=>h(u=>!u),title:"Menu",children:e.jsx(Ys,{className:"h-5 w-5"})}),e.jsx("div",{className:"bg-primary p-2 rounded-lg",children:e.jsx(xs,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-baseline gap-2",children:["StreamNZB",_&&e.jsxs("span",{className:"text-xs font-normal text-muted-foreground",children:["v",_]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"High-performance Usenet Streaming"})]})]}),e.jsx("div",{className:"hidden md:flex items-center",children:e.jsxs("div",{className:"flex items-center gap-1.5 bg-secondary/60 border border-border/60 rounded-xl px-1.5 py-1",children:[e.jsxs("div",{className:"flex items-center bg-background/70 rounded-lg p-0.5 gap-0.5",children:[e.jsx(E,{variant:Z==="light"?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Q("light"),children:e.jsx(hs,{className:"h-4 w-4"})}),e.jsx(E,{variant:Z==="dark"?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Q("dark"),children:e.jsx(ps,{className:"h-4 w-4"})}),e.jsx(E,{variant:Z==="system"?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Q("system"),children:e.jsx(fs,{className:"h-4 w-4"})})]}),e.jsxs(Xe,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(E,{variant:"outline",size:"icon",className:"h-8 w-8 md:w-auto md:px-3 gap-2",disabled:!g,title:"Install options",children:[e.jsx(gs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Install"}),e.jsx(Ge,{className:"hidden md:inline h-4 w-4 opacity-50"})]})}),e.jsxs(Fe,{align:"end",children:[e.jsxs(te,{onClick:()=>O("web"),children:[e.jsx(He,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Stremio Web"})]}),e.jsxs(te,{onClick:()=>O("copy"),children:[Ie?e.jsx(ve,{className:"mr-2 h-4 w-4"}):e.jsx(qe,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:Ie?"Copied!":"Copy Link"})]})]})]}),e.jsxs(E,{variant:"outline",size:"icon",onClick:()=>ee(!0),className:"h-8 w-8 md:w-auto md:px-3 gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Settings"})]}),a&&a!=="legacy"&&e.jsxs(E,{variant:"outline",size:"icon",onClick:x,className:"h-8 w-8 md:w-auto md:px-3 gap-2",title:"Logout",children:[e.jsx(js,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Logout"})]}),e.jsxs(E,{variant:"default",size:"icon",className:"h-8 w-8 md:w-auto md:px-3 gap-2 bg-[#5865F2] hover:bg-[#4752C4] text-white",onClick:()=>window.open("https://snzb.stream/discord","_blank"),children:[e.jsx(Ss,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden md:inline",children:"Discord"})]})]})})]}),ye&&e.jsx("div",{className:"md:hidden fixed inset-0 z-50 bg-background",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Menu"}),e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>h(!1),className:"h-9 w-9",children:e.jsx(Le,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"flex flex-col gap-4 max-w-md mx-auto",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Theme"}),e.jsxs("div",{className:"flex items-center justify-center bg-secondary/70 rounded-lg p-1 gap-1",children:[e.jsx(E,{variant:Z==="light"?"default":"ghost",size:"icon",className:"h-10 w-10",onClick:()=>Q("light"),children:e.jsx(hs,{className:"h-5 w-5"})}),e.jsx(E,{variant:Z==="dark"?"default":"ghost",size:"icon",className:"h-10 w-10",onClick:()=>Q("dark"),children:e.jsx(ps,{className:"h-5 w-5"})}),e.jsx(E,{variant:Z==="system"?"default":"ghost",size:"icon",className:"h-10 w-10",onClick:()=>Q("system"),children:e.jsx(fs,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Install"}),e.jsxs(Xe,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(E,{variant:"outline",className:"w-full justify-start gap-3 h-12",disabled:!g,children:[e.jsx(gs,{className:"h-5 w-5"}),e.jsx("span",{children:"Install Addon"}),e.jsx(Ge,{className:"h-4 w-4 opacity-50 ml-auto"})]})}),e.jsxs(Fe,{align:"start",className:"w-[calc(100vw-4rem)]",children:[e.jsxs(te,{onClick:()=>O("web"),children:[e.jsx(He,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Stremio Web"})]}),e.jsxs(te,{onClick:()=>O("copy"),children:[Ie?e.jsx(ve,{className:"mr-2 h-4 w-4"}):e.jsx(qe,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:Ie?"Copied!":"Copy Link"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t",children:[e.jsxs(E,{variant:"outline",className:"w-full justify-start gap-3 h-12",onClick:()=>{ee(!0),h(!1)},children:[e.jsx(We,{className:"h-5 w-5"}),e.jsx("span",{children:"Settings"})]}),a&&a!=="legacy"&&e.jsxs(E,{variant:"ghost",className:"w-full justify-start gap-3 h-12",onClick:()=>{x(),h(!1)},children:[e.jsx(js,{className:"h-5 w-5"}),e.jsx("span",{children:"Logout"})]}),e.jsxs(E,{variant:"default",className:"w-full justify-start gap-3 h-12 bg-[#5865F2] hover:bg-[#4752C4] text-white",onClick:()=>window.open("https://snzb.stream/discord","_blank"),children:[e.jsx(Ss,{className:"h-5 w-5"}),e.jsx("span",{children:"Discord"})]})]})]})})]})}),ge&&e.jsx($a,{initialConfig:g,sendCommand:S,saveStatus:w,isSaving:L,adminToken:a&&a!=="legacy"?t:null,onClose:()=>{ee(!1),k({type:"",msg:"",errors:null})}}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(q,{className:"flex flex-col",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(J,{className:"text-sm font-medium",children:"Active Connections"}),e.jsx(ia,{className:`h-4 w-4 ${c.active_sessions?.length>0?"text-primary animate-pulse":"text-muted-foreground"}`})]}),e.jsx(U,{className:"flex-1 overflow-y-auto max-h-[140px] pt-2",children:c.active_sessions?.length>0?e.jsx("div",{className:"space-y-3",children:c.active_sessions.map(u=>e.jsxs("div",{className:"group relative bg-secondary/30 rounded-md p-2 pr-10",children:[e.jsx("div",{className:"text-xs font-bold truncate pr-2",title:u.title,children:u.title}),e.jsx("div",{className:"text-[10px] text-muted-foreground truncate",children:u.clients.join(", ")}),e.jsx(E,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 text-destructive hover:bg-destructive/10",onClick:()=>S("close_session",{id:u.id}),children:e.jsx(Le,{className:"h-4 w-4"})})]},u.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground py-4",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:"0"}),e.jsx("p",{className:"text-xs mt-1",children:"No active playback"})]})})]}),e.jsxs(q,{className:"md:col-span-2 overflow-hidden flex flex-col",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-sm font-medium",children:"Total Speed"}),e.jsxs("div",{className:"text-2xl font-bold mt-1",children:[c.total_speed_mbps.toFixed(1)," ",e.jsx("span",{className:"text-sm font-normal text-muted-foreground",children:"Mbps"})]})]}),e.jsx(xs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(U,{className:"p-0 flex-1",children:e.jsx(Ke,{config:Cs,className:"h-[120px] w-full",children:e.jsxs(bs,{data:se,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"fillSpeed",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(var(--chart-1))",stopOpacity:.4}),e.jsx("stop",{offset:"100%",stopColor:"hsl(var(--chart-1))",stopOpacity:.1})]})}),e.jsx(vs,{type:"monotone",dataKey:"speed",stroke:"hsl(var(--chart-1))",fill:"url(#fillSpeed)",strokeWidth:2,isAnimationActive:!1}),e.jsx(ks,{content:e.jsx(Je,{hideLabel:!0})})]})})})]}),e.jsxs(q,{className:"md:col-span-3 overflow-hidden flex flex-col",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-sm font-medium",children:"Pool Connections"}),e.jsxs("div",{className:"text-2xl font-bold mt-1",children:[c.active_connections," ",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",c.total_connections," active"]})]})]}),e.jsx(ca,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(U,{className:"p-0 flex-1",children:e.jsx(Ke,{config:Cs,className:"h-[80px] w-full",children:e.jsxs(bs,{data:fe,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"fillConns",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"hsl(var(--chart-2))",stopOpacity:.4}),e.jsx("stop",{offset:"100%",stopColor:"hsl(var(--chart-2))",stopOpacity:.1})]})}),e.jsx(vs,{type:"step",dataKey:"conns",stroke:"hsl(var(--chart-2))",fill:"url(#fillConns)",strokeWidth:2,isAnimationActive:!1}),e.jsx(ks,{content:e.jsx(Je,{hideLabel:!0})})]})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Usenet Providers"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:c.providers.map(u=>e.jsxs(q,{className:"bg-card/50",children:[e.jsxs(W,{className:"p-4 pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-bold truncate leading-tight",title:u.name,children:u.name}),e.jsx(Oe,{variant:"outline",className:"text-[10px] py-0 h-4",children:u.max_conns})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground truncate",title:u.host,children:u.host})]}),e.jsxs(U,{className:"p-4 pt-0",children:[e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] uppercase text-muted-foreground font-medium",children:"Load"}),e.jsxs("span",{className:"text-sm font-bold",children:[(u.active_conns/(u.max_conns||1)*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex flex-col text-right",children:[e.jsx("span",{className:"text-[10px] uppercase text-muted-foreground font-medium",children:"Speed"}),e.jsxs("span",{className:"text-sm font-bold text-primary",children:[u.current_speed_mbps.toFixed(1)," ",e.jsx("span",{className:"text-[10px]",children:"M"})]})]})]}),e.jsx("div",{className:"w-full bg-secondary h-1 rounded-full mt-2 overflow-hidden",children:e.jsx("div",{className:"bg-primary h-full transition-all duration-500",style:{width:`${u.active_conns/(u.max_conns||1)*100}%`}})}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-[10px] text-muted-foreground",children:[e.jsxs("span",{children:["Downloaded:",e.jsxs("span",{className:"font-semibold text-foreground",children:[(u.downloaded_mb?.toFixed,u.downloaded_mb.toFixed(1))," MB"]})]}),c.total_downloaded_mb>0&&e.jsxs("span",{children:["Usage:",e.jsxs("span",{className:"font-semibold text-foreground",children:[u.usage_percent.toFixed(0),"%"]})]})]})]})]},u.name))})]}),e.jsxs("div",{className:"space-y-4 mt-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(da,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Indexers"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[c.indexers?.map(u=>e.jsxs(q,{className:"bg-card/50",children:[e.jsx(W,{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-bold truncate leading-tight",title:u.name,children:u.name}),e.jsx(Oe,{variant:"secondary",className:"text-[10px] py-0 h-4",children:"Indexer"})]})}),e.jsxs(U,{className:"p-4 pt-0 space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] uppercase text-muted-foreground font-medium mb-1",children:[e.jsx("span",{children:"API Hits"}),e.jsxs("span",{children:[u.api_hits_used," / ",u.api_hits_limit>0?u.api_hits_limit:""]})]}),u.api_hits_limit>0&&e.jsx("div",{className:"w-full bg-secondary h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 ${u.api_hits_remaining/u.api_hits_limit<.2?"bg-destructive":"bg-primary"}`,style:{width:`${(u.api_hits_limit-u.api_hits_remaining)/u.api_hits_limit*100}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] uppercase text-muted-foreground font-medium mb-1",children:[e.jsx("span",{children:"Downloads"}),e.jsxs("span",{children:[u.downloads_used," / ",u.downloads_limit>0?u.downloads_limit:""]})]}),u.downloads_limit>0&&e.jsx("div",{className:"w-full bg-secondary h-1.5 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 ${u.downloads_remaining/u.downloads_limit<.2?"bg-destructive":"bg-primary"}`,style:{width:`${(u.downloads_limit-u.downloads_remaining)/u.downloads_limit*100}%`}})})]})]})]},u.name)),(!c.indexers||c.indexers.length===0)&&e.jsx("div",{className:"col-span-full py-8 text-center border border-dashed rounded-lg text-muted-foreground text-sm",children:"No internal indexers configured."})]})]}),e.jsx("div",{className:"mt-8",children:e.jsxs(q,{className:"flex flex-col h-[300px]",children:[e.jsx(W,{className:"py-3 px-4 border-b bg-muted/20",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(J,{className:"text-sm font-medium",children:"System Logs"})]})}),e.jsx(U,{className:"flex-1 p-0 overflow-hidden relative",children:e.jsxs("div",{className:"absolute inset-0 overflow-y-auto p-4 font-mono text-xs space-y-1",children:[R.length===0&&e.jsx("div",{className:"text-muted-foreground italic",children:"Waiting for logs..."}),R.map((u,B)=>e.jsx("div",{className:"whitespace-pre-wrap break-all border-b border-border/40 pb-0.5 mb-0.5 last:border-0",children:u},B)),e.jsx("div",{ref:je})]})})]})})]}):e.jsx(La,{onLogin:be,version:_})}zr.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Va,{})}));
